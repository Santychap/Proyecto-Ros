<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/base :: layout('Mis Reservas', ~{::section})">

<section th:fragment="section">

  <!-- Encabezado de página -->
  <div class="page-header">
    <div class="btn-group-header">
      <h1><i class="bi bi-calendar-check me-2"></i>Mi Perfil</h1>
      <div class="d-flex gap-2">
        <a href="/reserva" class="btn btn-success">
          <i class="bi bi-calendar-plus me-2"></i>Nueva Reserva
        </a>
      </div>
    </div>
  </div>
  
  <!-- Navegación del perfil -->
  <div class="card mb-4">
    <div class="card-body">
      <div class="row text-center">
        <div class="col-md-3">
          <a href="/mi-perfil" class="btn btn-outline-primary w-100">
            <i class="bi bi-person me-2"></i>Mi Perfil
          </a>
        </div>
        <div class="col-md-3">
          <a href="/mis-pedidos" class="btn btn-outline-primary w-100">
            <i class="bi bi-cart me-2"></i>Mis Pedidos
          </a>
        </div>
        <div class="col-md-3">
          <a href="/mis-reservas" class="btn btn-primary w-100">
            <i class="bi bi-calendar me-2"></i>Mis Reservas
          </a>
        </div>
        <div class="col-md-3">
          <a href="/mis-pagos" class="btn btn-outline-primary w-100">
            <i class="bi bi-credit-card me-2"></i>Mis Pagos
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Sección de contenido -->
  <div class="content-section">
    <!-- Resumen de reservas -->
    <div class="row mb-4">
      <div class="col-md-3 col-sm-6 mb-3">
        <div class="card text-center">
          <div class="card-body">
            <h5 class="card-title text-warning">Total Reservas</h5>
            <h3 class="text-info" th:text="${reservas.size()}">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 mb-3">
        <div class="card text-center">
          <div class="card-body">
            <h5 class="card-title text-warning">Próximas</h5>
            <h3 class="text-warning" th:text="${proximas}">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 mb-3">
        <div class="card text-center">
          <div class="card-body">
            <h5 class="card-title text-warning">Completadas</h5>
            <h3 class="text-success" th:text="${completadas}">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6 mb-3">
        <div class="card text-center">
          <div class="card-body">
            <h5 class="card-title text-warning">Canceladas</h5>
            <h3 class="text-danger" th:text="${canceladas}">0</h3>
          </div>
        </div>
      </div>
    </div>

    <h3><i class="bi bi-calendar me-2"></i>Mis Reservas</h3>
    
    <!-- Lista de reservas -->
    <div class="row" th:if="${!reservas.isEmpty()}">
      <div class="col-lg-6 mb-4" th:each="reserva : ${reservas}">
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <div>
              <strong th:text="'Reserva #' + ${reserva.id}">Reserva #001</strong>
              <small class="text-muted ms-2" th:text="${#dates.format(reserva.fechaReserva, 'dd/MM/yyyy')}">15/01/2025</small>
            </div>
            <span class="badge" 
                  th:classappend="${reserva.estado == 'CONFIRMADA' ? 'bg-success' : (reserva.estado == 'PENDIENTE' ? 'bg-warning' : 'bg-danger')}"
                  th:text="${reserva.estado}">Estado</span>
          </div>
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <small><i class="bi bi-clock me-1"></i><span th:text="${reserva.hora ?: 'Sin hora'}">Hora</span></small><br>
                <small><i class="bi bi-people me-1"></i><span th:text="${reserva.numeroPersonas} + ' personas'">Personas</span></small>
              </div>
              <small class="text-muted" th:text="'Mesa: ' + (${reserva.mesa?.numeroMesa} ?: 'Sin asignar')">Mesa: 1</small>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensaje si no hay reservas -->
    <div class="text-center py-5" th:if="${reservas.isEmpty()}">
      <i class="bi bi-calendar-x display-1 text-muted"></i>
      <h4 class="text-muted mt-3">No tienes reservas aún</h4>
      <p class="text-muted">Realiza tu primera reserva y asegura tu mesa favorita</p>
      <a href="/reserva" class="btn btn-success">
        <i class="bi bi-calendar-plus me-2"></i>Hacer Primera Reserva
      </a>
    </div>
  </div>

</section>

</html>
