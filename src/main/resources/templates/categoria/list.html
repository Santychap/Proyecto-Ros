<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="layout/base :: layout('Gestión de Categorías', ~{::section})">

<section th:fragment="section">

  <!-- Encabezado de página -->
  <div class="page-header">
    <div class="btn-group-header">
      <h1><i class="bi bi-tags me-2"></i>Gestión de Categorías</h1>
      <a th:href="@{/categorias/new}" class="btn btn-success">
        <i class="bi bi-plus-circle me-2"></i>Nueva Categoría
      </a>
    </div>
  </div>

  <!-- Sección de contenido -->
  <div class="content-section">
    <!-- Estadísticas rápidas -->
    <div class="row mb-4">
      <div class="col-md-4 col-sm-6 mb-3">
        <div class="card text-center">
          <div class="card-body">
            <h5 class="card-title text-warning">Total Categorías</h5>
            <h3 class="text-info" th:text="${#lists.size(categorias)}">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6 mb-3">
        <div class="card text-center">
          <div class="card-body">
            <h5 class="card-title text-warning">Activas</h5>
            <h3 class="text-success" th:text="${#lists.size(categorias)}">0</h3>
          </div>
        </div>
      </div>
      <div class="col-md-4 col-sm-6 mb-3">
        <div class="card text-center">
          <div class="card-body">
            <h5 class="card-title text-warning">Productos</h5>
            <h3 class="text-warning">--</h3>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabla de categorías -->
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
        <tr>
          <th><i class="bi bi-hash me-1"></i>ID</th>
          <th><i class="bi bi-tag me-1"></i>Nombre</th>
          <th><i class="bi bi-file-text me-1"></i>Descripción</th>
          <th><i class="bi bi-calendar me-1"></i>Fecha Creación</th>
          <th><i class="bi bi-gear me-1"></i>Acciones</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="categoria : ${categorias}">
          <td><strong th:text="${categoria.idCategoria}"></strong></td>
          <td>
            <div class="d-flex align-items-center">
              <i class="bi bi-tag-fill me-2 text-warning"></i>
              <span th:text="${categoria.nombre}"></span>
            </div>
          </td>
          <td>
            <span class="text-muted" th:text="${#strings.abbreviate(categoria.descripcion, 50)}"
                  th:title="${categoria.descripcion}"></span>
          </td>
          <td>
            <small th:text="${#dates.format(categoria.createdAt, 'dd/MM/yyyy')}"></small>
          </td>
          <td>
            <div class="btn-group-actions">
              <a th:href="@{'/categorias/edit/' + ${categoria.idCategoria}}" class="btn btn-warning btn-sm" title="Editar categoría">
                <i class="bi bi-pencil-square"></i>
                <span class="d-none d-md-inline ms-1">Editar</span>
              </a>
              <form th:action="@{'/categorias/delete/' + ${categoria.idCategoria}}" method="post" style="display:inline"
                    onsubmit="return confirm('¿Está seguro de eliminar esta categoría?');">
                <button class="btn btn-danger btn-sm" title="Eliminar categoría">
                  <i class="bi bi-trash"></i>
                  <span class="d-none d-md-inline ms-1">Eliminar</span>
                </button>
              </form>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Mensaje si no hay categorías -->
    <div th:if="${#lists.isEmpty(categorias)}" class="text-center py-5">
      <i class="bi bi-tags display-1 text-muted"></i>
      <h4 class="text-muted mt-3">No hay categorías registradas</h4>
      <p class="text-muted">Comienza creando la primera categoría para organizar tus productos</p>
      <a th:href="@{/categorias/new}" class="btn btn-success">
        <i class="bi bi-plus-circle me-2"></i>Crear Primera Categoría
      </a>
    </div>
  </div>

</section>

</html>